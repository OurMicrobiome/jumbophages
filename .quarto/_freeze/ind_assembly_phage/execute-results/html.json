{
  "hash": "866d1b86d041c688f6e2cb5c88148afe",
  "result": {
    "markdown": "---\ntitle: \"Targeted enrichment and discovery of jumbo phages\"\nauthor: \"Jeffrey Blanchard\"\ndate: \"5/4/2023\"\n---\n\n\n# Overview\n\nThis report is an analysis of the Barre Woods filter metagenomes from the individual assembles.  Assembly, binning, quality control and classification was done on KBase https://narrative.kbase.us/narrative/145971  . The checkv and virsorter files were downloaded to this project folder.\n\n## Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load libraries\nlibrary(tidyverse)\nlibrary(DT)\n```\n:::\n\n\n## Import Data\n\n### Import vsorter files. Filter to include just the dsDNAphages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter <- read_tsv(\"data_individual_assembly/all-ind-virsorter-final-viral-score.tsv\") |> \n  filter(max_score_group == \"dsDNAphage\") |> \n  select(-c(dsDNAphage, ssDNA, NCLDV, lavidaviridae)) |> \n  rename(\"contig_id\" = \"seqname\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheckv <- read_tsv(\"data_individual_assembly/all-ind-checkv_quality_summary.tsv\") \n```\n:::\n\n\n\n### Join checkv and virsorter dataframes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv <- left_join(virsorter, checkv, by = \"contig_id\")\n```\n:::\n\n\n### filter to high quality and complete\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv_HQ <- virsorter_checkv |> \n  filter(checkv_quality == \"Complete\" | checkv_quality == \"High-quality\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# write summary file\nwrite_tsv(virsorter_checkv, \"data_individual_assembly/all-ind-virsorter_checkv.tsv\") \nwrite_tsv(virsorter_checkv_HQ, \"data_individual_assembly/all-ind-virsorter_checkv_HQ.tsv\") \n```\n:::\n\n\n## Data analysis\n\n### Barchart of checkv_quality\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv |>  \nggplot(aes(x = checkv_quality)) + \n  geom_bar() \n```\n\n::: {.cell-output-display}\n![](ind_assembly_phage_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### Table with % checkv_quality in each category\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv |> \n  mutate(across(checkv_quality, as_factor)) |> \n  group_by(checkv_quality) |> \n  summarise(n = n()) |>\n  mutate(freq = n / sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 3\n  checkv_quality     n     freq\n  <fct>          <int>    <dbl>\n1 High-quality     418 0.0209  \n2 Complete          13 0.000650\n3 Medium-quality   506 0.0253  \n4 Low-quality    12703 0.635   \n5 Not-determined  6238 0.312   \n6 <NA>             127 0.00635 \n```\n:::\n:::\n\n\n\n### Histogram\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv |> \nggplot(aes(x = length, fill = checkv_quality)) + \n  geom_histogram(colour = \"black\",  binwidth=10000) +\n  ggtitle(\"Genome size of Phage\") +\n  xlab(\"Genome size\") + \n  theme(text = element_text(size = 20, color=\"black\"))\n```\n\n::: {.cell-output-display}\n![](ind_assembly_phage_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  theme(axis.text.x = element_text(angle = 90)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 1\n $ axis.text.x:List of 11\n  ..$ family       : NULL\n  ..$ face         : NULL\n  ..$ colour       : NULL\n  ..$ size         : NULL\n  ..$ hjust        : NULL\n  ..$ vjust        : NULL\n  ..$ angle        : num 90\n  ..$ lineheight   : NULL\n  ..$ margin       : NULL\n  ..$ debug        : NULL\n  ..$ inherit.blank: logi FALSE\n  ..- attr(*, \"class\")= chr [1:2] \"element_text\" \"element\"\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi FALSE\n - attr(*, \"validate\")= logi TRUE\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvirsorter_checkv_HQ |> \nggplot(aes(x = length, fill = checkv_quality)) + \n  geom_histogram(colour = \"black\",  binwidth=10000) +\n  ggtitle(\"Genome size of Phage\") +\n  xlab(\"Genome size\") + \n  #theme(text = element_text(size = 20, color=\"black\"))\n  theme(axis.text.x = element_text(angle = 45)) \n```\n\n::: {.cell-output-display}\n![](ind_assembly_phage_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ind_assembly_phage_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}